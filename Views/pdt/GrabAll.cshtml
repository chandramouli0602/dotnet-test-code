@model List<MediatorCrud.Models.Pdt>

@{
	ViewData["Title"] = "Product List";
}

<h2>@ViewData["Title"]</h2>
<p>  
	<a class="btn btn-primary" asp-action="Erect">Add Product</a>
</p>

<table class="table table-bordered">
	<thead class="table-dark">
		<tr>
			<th>Name</th>
			<th>Price</th>
			<th>Description</th>
			<th>Stock</th>
			<th>Category</th>
			<th>Actions</th>
		</tr>
	</thead>
	<tbody>
		@foreach(var item in Model)

		{
			<tr>
				<td>@item.PdtName</td>
				<td>@item.PdtPrice</td>
				<td>@item.PdtDescr</td>
				<td>@item.PdtStk</td>
				<td>@item.catgry.catgryNmae</td>
				<td>
					<a class="btn btn-warning btn-sm" asp-action="Rescript" asp-route-id="@item.Id">Edit</a>
					<a href="#" class="btn btn-danger btn-sm"
					   data-bs-toggle="modal"
					   data-bs-target="#deleteModal"
					   data-product-id="@item.Id">
						Delete
					</a>
				</td>
			</tr>
		}
	</tbody>
</table>




<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<form asp-action="Expunge" method="post">
				<div class="modal-header bg-danger text-white">
					<h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					Are you sure you want to delete this product?
					<input type="hidden" id="deleteProductId" name="id" />
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="submit" class="btn btn-danger">Delete</button>
				</div>
			</form>
		</div>
	</div>
</div>

@section Scripts {
	<script>
		var deleteModal = document.getElementById('deleteModal');
		deleteModal.addEventListener('show.bs.modal', function (event) {
			var button = event.relatedTarget;
			var productId = button.getAttribute('data-product-id');
			var input = deleteModal.querySelector('#deleteProductId');
			input.value = productId;
		});
	</script>
}
